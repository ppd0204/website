var OSMBuildings=function(){function e(a,b){var d=a[0]-b[0],f=a[1]-b[1];return d*d+f*f}function J(a){for(var b=0,d=0,f=0,g=a.length-3;f<g;f+=2)b+=a[f],d+=a[f+1];a=(a.length-2)/2;return[b/a<<0,d/a<<0]}function Aa(a){var b,d,f,g,e=0,n,s;n=0;for(s=a.length-3;n<s;n+=2)b=a[n],d=a[n+1],f=a[n+2],g=a[n+3],e+=b*g-f*d;if("CW"===(0<e/2?"CW":"CCW"))return a;b=[];for(d=a.length-2;0<=d;d-=2)b.push(a[d],a[d+1]);return b}var Ba=Ba||Array,Ca=Ca||Array,h=Math,La=h.exp,Ma=h.log,Na=h.sin,Oa=h.cos,ta=h.tan,Pa=h.atan,
na=h.min,ua=h.max,Da=document,T,aa=function(a){var b,d,f;if(0===a.s)b=d=f=a.l;else{f=0.5>a.l?a.l*(1+a.s):a.l+a.s-a.l*a.s;var g=2*a.l-f;a.h/=360;b=U(g,f,a.h+1/3);d=U(g,f,a.h);f=U(g,f,a.h-1/3)}return new y(255*b<<0,255*d<<0,255*f<<0,a.a)},U=function(a,b,d){0>d&&(d+=1);1<d&&(d-=1);return d<1/6?a+6*(b-a)*d:0.5>d?b:d<2/3?a+6*(b-a)*(2/3-d):a},y=function(a,b,d,f){this.r=a;this.g=b;this.b=d;this.a=4>arguments.length?1:f},h=y.prototype;h.toString=function(){return"rgba("+[this.r<<0,this.g<<0,this.b<<0,this.a.toFixed(2)].join()+
")"};h.setLightness=function(a){var b=y.toHSLA(this);b.l*=a;b.l=Math.min(1,Math.max(0,b.l));return aa(b)};h.setAlpha=function(a){return new y(this.r,this.g,this.b,this.a*a)};y.parse=function(a){var b;a+="";if(~a.indexOf("#")&&(b=a.match(/^#?(\w{2})(\w{2})(\w{2})(\w{2})?$/)))return new y(parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16),b[4]?parseInt(b[4],16)/255:1);if(b=a.match(/rgba?\((\d+)\D+(\d+)\D+(\d+)(\D+([\d.]+))?\)/))return new y(parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10),b[4]?
parseFloat(b[5]):1);if(b=a.match(/hsla?\(([\d.]+)\D+([\d.]+)\D+([\d.]+)(\D+([\d.]+))?\)/))return aa({h:parseInt(b[1],10),s:parseFloat(b[2]),l:parseFloat(b[3]),a:b[4]?parseFloat(b[5]):1})};y.toHSLA=function(a){var b=a.r/255,d=a.g/255,f=a.b/255,g=Math.max(b,d,f),e=Math.min(b,d,f),n,s=(g+e)/2,h;if(g===e)n=e=0;else{h=g-e;e=0.5<s?h/(2-g-e):h/(g+e);switch(g){case b:n=(d-f)/h+(d<f?6:0);break;case d:n=(f-b)/h+2;break;case f:n=(b-d)/h+4}n/=6}return{h:360*n,s:e,l:s,a:a.a}};T=y;var Ea,h=Math,K=h.PI,m=h.sin,
z=h.cos,ba=h.tan,ca=h.asin,da=h.atan2,E=K/180,O=23.4397*E;Ea=function(a,b,d){d=E*-d;b*=E;a=a.valueOf()/864E5-0.5+2440588-2451545;var f=E*(357.5291+0.98560028*a),g=E*(1.9148*m(f)+0.02*m(2*f)+3E-4*m(3*f)),g=f+g+102.9372*E+K,f=ca(m(0)*z(O)+z(0)*m(O)*m(g)),g=da(m(g)*z(O)-ba(0)*m(O),z(g));d=E*(280.16+360.9856235*a)-d-g;return{altitude:ca(m(b)*m(f)+z(b)*z(f)*z(d)),azimuth:da(m(d),z(d)*m(b)-ba(f)*z(b))-K/2}};var Fa,F=function(a){var b=parseFloat(a);return~a.indexOf("m")?b<<0:~a.indexOf("yd")?b*Qa<<0:~a.indexOf("ft")?
b*Ga<<0:~a.indexOf("'")?(a=a.split("'"),a[0]*Ga+a[1]*Ra<<0):b<<0},v=function(a){a=a.toLowerCase();return"#"===a[0]?a:Sa[a]||null},H=function(a){a=a.toLowerCase();return"#"===a[0]?a:Ta[Ua[a]||a]||null},Ha=function(a){return(a=a.tags)&&!a.landuse&&(a.building||a["building:part"])&&(!a.layer||0<=a.layer)},Ia=function(a){if(a){for(var b=[],d,f=0,g=a.length;f<g;f++)d=M[a[f]],b.push(d[0],d[1]);b[b.length-2]!==b[0]&&b[b.length-1]!==b[1]&&b.push(b[0],b[1]);if(!(8>b.length))return b}},ea=function(a){var b=
0,d=0;a.height&&(b=F(a.height));!b&&a["building:height"]&&(b=F(a["building:height"]));!b&&a.levels&&(b=a.levels*P<<0);!b&&a["building:levels"]&&(b=a["building:levels"]*P<<0);a.min_height&&(d=F(a.min_height));!d&&a["building:min_height"]&&(d=F(a["building:min_height"]));!d&&a.min_level&&(d=a.min_level*P<<0);!d&&a["building:min_level"]&&(d=a["building:min_level"]*P<<0);var f,g;a["building:material"]&&(f=H(a["building:material"]));a["building:facade:material"]&&(f=H(a["building:facade:material"]));a["building:cladding"]&&
(f=H(a["building:cladding"]));a["building:color"]&&(f=v(a["building:color"]));a["building:colour"]&&(f=v(a["building:colour"]));a["roof:material"]&&(g=H(a["roof:material"]));a["building:roof:material"]&&(g=H(a["building:roof:material"]));a["roof:color"]&&(g=v(a["roof:color"]));a["roof:colour"]&&(g=v(a["roof:colour"]));a["building:roof:color"]&&(g=v(a["building:roof:color"]));a["building:roof:colour"]&&(g=v(a["building:roof:colour"]));return{height:b,minHeight:d,wallColor:f,roofColor:g}},Ja=function(a,
b,d){a={id:a,footprint:Aa(d)};b.height&&(a.height=b.height);b.minHeight&&(a.minHeight=b.minHeight);b.wallColor&&(a.wallColor=b.wallColor);b.roofColor&&(a.roofColor=b.roofColor);W.push(a)},Qa=0.9144,Ga=0.3048,Ra=0.0254,P=3,Sa={black:"#000000",white:"#ffffff",brown:"#8b4513",green:"#00ff7f",grey:"#bebebe",gray:"#bebebe",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",yellow:"#ffff00",red:"#ff0000",blue:"#0000ff"},Ua={asphalt:"tar_paper",bitumen:"tar_paper",block:"stone",bricks:"brick",glas:"glass",glassfront:"glass",
grass:"plants",masonry:"stone",granite:"stone",panels:"panel",paving_stones:"stone",plastered:"plaster",rooftiles:"roof_tiles",roofingfelt:"tar_paper",sandstone:"stone",sheet:"canvas",sheets:"canvas",shingle:"tar_paper",shingles:"tar_paper",slates:"slate",steel:"metal",tar:"tar_paper",tent:"canvas",thatch:"plants",tile:"roof_tiles",tiles:"roof_tiles"},Ta={brick:"#cc7755",bronze:"#ffeecc",canvas:"#fff8f0",concrete:"#999999",copper:"#a0e0d0",glass:"#e8f8f8",gold:"#ffcc00",plants:"#009933",metal:"#aaaaaa",
panel:"#fff8f0",plaster:"#999999",roof_tiles:"#f08060",silver:"#cccccc",slate:"#666666",stone:"#996666",tar_paper:"#333333",wood:"#deb887"},M,X,W;Fa=function(a){M={};X={};W=[];for(var b,d=0,f=a.length;d<f;d++)switch(b=a[d],b.type){case "node":M[b.id]=[b.lat,b.lon];break;case "way":var g=void 0,e=void 0;Ha(b)?(g=ea(b.tags),(e=Ia(b.nodes))&&Ja(b.id,g,e)):(g=b.tags)&&(!g.highway&&!g.railway&&!g.landuse)&&(X[b.id]=b);break;case "relation":var h=g=g=void 0,e=void 0;if(Ha(b)&&("multipolygon"===b.tags.type||
"building"===b.tags.type)){a:{for(var g=b.members,e=void 0,h=0,s=g.length;h<s;h++)if(e=g[h],"way"===e.type&&"outer"===e.role){g=e;break a}g=void 0}if(g&&(b=ea(b.tags),g=X[g.ref]))if(h=ea(g.tags),e=Ia(g.nodes)){s=void 0;for(s in b)h[s]||(h[s]=b[s]);Ja(g.id,h,e)}}}return W};var fa=Math.PI,Ka=fa/2,Va=fa/4,Wa=180/fa,Xa=256,Ya="latitude",Za="longitude",h=function(){function a(a,b){var c={};a/=E;b/=E;c[Ya]=0>=b?90:1<=b?-90:Wa*(2*Pa(La(fa*(1-2*b)))-Ka);c[Za]=360*(1===a?1:(a%1+1)%1)-180;return c}function b(a,
b,c){function d(a){if("XDomainRequest"in window&&a!==j.readyState&&(j.readyState=a,j.onreadystatechange))j.onreadystatechange()}a=a.replace(/\{ *([\w_]+) *\}/g,function(a,$a){return b[$a]||a});var j="XDomainRequest"in window?new XDomainRequest:new XMLHttpRequest;j.onerror=function(){j.status=500;j.statusText="Error";d(4)};j.ontimeout=function(){j.status=408;j.statusText="Timeout";d(4)};j.onprogress=function(){d(3)};j.onload=function(){j.status=200;j.statusText="Ok";d(4)};j.onreadystatechange=function(){4===
j.readyState&&j.status&&!(200>j.status||299<j.status)&&c&&j.responseText&&c(JSON.parse(j.responseText))};d(0);j.open("GET",a);d(1);j.send(null);d(2);return j}function d(){ga.render();oa.render();f()}function f(){w.clearRect(0,0,s,m);if(!(Q<F||ha)){var a,b,c,d,j,f,va,x,k,ab=oa.MAX_HEIGHT,p=[ia+I,ja+A],u,q,l,t,V,r;C.renderItems.sort(function(a,b){return e(b.center,p)/b.height-e(a.center,p)/a.height});a=0;for(b=C.renderItems.length;a<b;a++)if(j=C.renderItems[a],!(j.height<=ab)){q=!1;f=j.footprint;u=
[];c=0;for(d=f.length-1;c<d;c+=2)u[c]=x=f[c]-I,u[c+1]=k=f[c+1]-A,q||(q=0<x&&x<s&&0<k&&k<m);if(q){c=1>j.scale?j.height*j.scale:j.height;f=Y/(Y-c);j.minHeight&&(c=1>j.scale?j.minHeight*j.scale:j.minHeight,va=Y/(Y-c));x=[];c=0;for(d=u.length-3;c<d;c+=2)k=u[c],l=u[c+1],q=u[c+2],t=u[c+3],V=h(k,l,f),r=h(q,t,f),j.minHeight&&(l=h(k,l,va),t=h(q,t,va),k=l.x,l=l.y,q=t.x,t=t.y),(q-k)*(V.y-l)>(V.x-k)*(t-l)&&(w.fillStyle=k<q&&l<t||k>q&&l>t?j.altColor||ka:j.wallColor||H,g([q,t,k,l,V.x,V.y,r.x,r.y])),x[c]=V.x,x[c+
1]=V.y;w.fillStyle=j.roofColor||la;w.strokeStyle=j.altColor||ka;g(x,!0)}}}}function g(a,b){if(a.length){w.beginPath();w.moveTo(a[0],a[1]);for(var c=2,d=a.length;c<d;c+=2)w.lineTo(a[c],a[c+1]);w.closePath();b&&w.stroke();w.fill()}}function h(a,b,c){return{x:(a-ia)*c+ia<<0,y:(b-ja)*c+ja<<0}}function n(a){Q=a;E=Xa<<Q;a=Q;var b=F,c=P;a=na(ua(a,b),c);N=1-na(ua(0+0.3*((a-b)/(c-b)),0),0.3);H=B.setAlpha(N)+"";ka=v.setAlpha(N)+"";la=Z.setAlpha(N)+""}var s=0,m=0,y=0,z=0,I=0,A=0,Q,E,w,B=new T(200,190,180),v=
B.setLightness(0.8),Z=B.setLightness(1.2),H=B+"",ka=v+"",la=Z+"",O,N=1,F=15,P=20,U,ia,ja,Y,ha,K=new Date,$={},M={add:function(a,b){$[a]={data:b,time:Date.now()}},get:function(a){return $[a]&&$[a].data},purge:function(){K.setMinutes(K.getMinutes()-5);for(var a in $)$[a].time<K&&delete $[a]}},C,ea=function(a){return function(b){W(b,a)}},W=function(a,b){if(a){var c;if("FeatureCollection"===a.type){c=a.features;var d,j,e,f,g=[],k,h,p,u,q,l,t,m;d=0;for(j=c.length;d<j;d++)if(k=c[d],"Feature"===k.type&&
(h=k.geometry,k=k.properties,"LineString"===h.type&&(l=p.length-1,p[0][0]===p[l][0]&&p[0][1]===p[l][1]&&(p=h.coordinates)),"Polygon"===h.type&&(p=h.coordinates),"MultiPolygon"===h.type&&(p=h.coordinates[0]),p)){if(k.color||k.wallColor)u=k.color||k.wallColor;k.roofColor&&(q=k.roofColor);h=p[0];m=[];t=k.height;e=l=0;for(f=h.length;e<f;e++)m.push(h[e][1],h[e][0]),l+=t||h[e][2]||0;e={id:k.id||m[0]+","+m[1],footprint:Aa(m)};l&&(e.height=l/h.length<<0);k.minHeight&&(e.minHeight=k.minHeight);u&&(e.wallColor=
u);q&&(e.roofColor=q);g.push(e)}c=g}else a.osm3s&&(c=Fa(a.elements));b&&M.add(b,c);X(c,!0)}},X=function(a,b){var c,e,j,f,g,h,k=[],m,p,u,q,l,t,r,s,n,y=P-Q;j=0;for(f=a.length;j<f;j++)if(n=s=r=null,m=a[j],u=3*(m.height||15)>>y)if(q=3*m.minHeight>>y,!(q>U)){p=m.footprint;l=new Ba(p.length);g=0;for(h=p.length-1;g<h;g+=2)c=p[g+1],e=na(1,ua(0,0.5-Ma(ta(Va+Ka*p[g]/180))/fa/2)),c=(c/360+0.5)*E<<0,e=e*E<<0,l[g]=c,l[g+1]=e;g=l;h=g.length/2;p=new Ca(h);l=0;c=h-1;var z=e=void 0,v=void 0,w=void 0,D=[],F=[],H=[];
for(p[l]=p[c]=1;c;){z=0;for(e=l+1;e<c;e++){var v=g[2*e],I=g[2*e+1],A=g[2*l],B=g[2*l+1],K=g[2*c],M=g[2*c+1],R=K-A,S=M-B,G=void 0;if(0!==R||0!==S)G=((v-A)*R+(I-B)*S)/(R*R+S*S),1<G?(A=K,B=M):0<G&&(A+=R*G,B+=S*G);R=v-A;S=I-B;v=R*R+S*S;v>z&&(w=e,z=v)}2<z&&(p[w]=1,D.push(l),F.push(w),D.push(w),F.push(c));l=D.pop();c=F.pop()}for(e=0;e<h;e++)p[e]&&H.push(g[2*e],g[2*e+1]);l=H;if(!(8>l.length)){if(m.wallColor&&(t=T.parse(m.wallColor)))r=t.setAlpha(N),s=""+r.setLightness(0.8),r=""+r;if(m.roofColor&&(t=T.parse(m.roofColor)))n=
""+t.setAlpha(N);k.push({id:m.id,footprint:l,height:na(u,U),minHeight:q,wallColor:r,altColor:s,roofColor:n,center:J(l)})}}f=0;for(m=k.length;f<m;f++)j=k[f],pa[j.id]||(j.scale=b?0:1,ma.renderItems.push(k[f]),pa[j.id]=1);O||(O=setInterval(function(){for(var a,b=!1,c=0,e=C.renderItems.length;c<e;c++)a=C.renderItems[c],1>a.scale&&(a.scale+=0.1,1<a.scale&&(a.scale=1),b=!0);d();b||(clearInterval(O),O=null)},33))},wa,pa={},ma={renderItems:[],load:function(a){wa=a||"http://overpass-api.de/api/interpreter?data=[out:json];(way[%22building%22]({s},{w},{n},{e});node(w);way[%22building:part%22=%22yes%22]({s},{w},{n},{e});node(w);relation[%22building%22]({s},{w},{n},{e});way(r);node(w););out;";
ma.update()},update:function(){if(wa&&!(15>Q)){var e=a(I,A),d=a(I+s,A+m),c=0.0075*(e.latitude/0.0075<<0)+0.0075,g=0.015*(d.longitude/0.015<<0)+0.015,d=0.0075*(d.latitude/0.0075<<0),e=0.015*(e.longitude/0.015<<0);M.purge();ma.renderItems=[];pa={};for(var j,f,h;d<=c;d+=0.0075)for(j=e;j<=g;j+=0.015)h=d+","+j,(f=M.get(h))?X(f):b(wa,{n:(1E4*(d+0.0075)<<0)/1E4,e:(1E4*(j+0.015)<<0)/1E4,s:(1E4*d<<0)/1E4,w:(1E4*j<<0)/1E4},ea(h))}},set:function(a){ma.renderItems=[];pa={};W(a)}};C=ma;var ga,ra=function(a,b,
c){return{x:a+qa.x*c,y:b+qa.y*c}},r,aa=!0,ba=new T(0,0,0),ca=null,qa={x:0,y:0},xa={setContext:function(a){r=a;xa.setDate((new Date).setHours(10))},enable:function(a){aa=!!a},render:function(){var b,d,c,e;r.clearRect(0,0,s,m);if(aa&&!(Q<F||ha))if(b=a(I+y,A+z),b=Ea(ca,b.latitude,b.longitude),!(0>=b.altitude)){d=1/ta(b.altitude);c=0.4/d;qa.x=Oa(b.azimuth)*d;qa.y=Na(b.azimuth)*d;ba.a=c;e=ba+"";var g,f,h,x,k,n,p,u,q,l,t,v,w=[];r.beginPath();b=0;for(d=C.renderItems.length;b<d;b++){f=C.renderItems[b];u=
!1;h=f.footprint;p=[];c=0;for(g=h.length-1;c<g;c+=2)p[c]=k=h[c]-I,p[c+1]=n=h[c+1]-A,u||(u=0<k&&k<s&&0<n&&n<m);if(u){h=1>f.scale?f.height*f.scale:f.height;f.minHeight&&(x=1>f.scale?f.minHeight*f.scale:f.minHeight);k=null;c=0;for(g=p.length-3;c<g;c+=2)n=p[c],q=p[c+1],u=p[c+2],l=p[c+3],t=ra(n,q,h),v=ra(u,l,h),f.minHeight&&(q=ra(n,q,x),l=ra(u,l,x),n=q.x,q=q.y,u=l.x,l=l.y),(u-n)*(t.y-q)>(t.x-n)*(l-q)?(1===k&&r.lineTo(n,q),k=0,c||r.moveTo(n,q),r.lineTo(u,l)):(0===k&&r.lineTo(t.x,t.y),k=1,c||r.moveTo(t.x,
t.y),r.lineTo(v.x,v.y));r.closePath();w.push(p)}}r.fillStyle=e;r.fill();r.globalCompositeOperation="destination-out";r.beginPath();b=0;for(d=w.length;b<d;b++){x=w[b];r.moveTo(x[0],x[1]);c=2;for(g=x.length;c<g;c+=2)r.lineTo(x[c],x[c+1]);r.lineTo(x[0],x[1]);r.closePath()}r.fillStyle="#00ff00";r.fill();r.globalCompositeOperation="source-over"}},setDate:function(a){ca=a;xa.render()}};ga=xa;var oa,D,da={MAX_HEIGHT:8,setContext:function(a){D=a},render:function(){D.clearRect(0,0,s,m);if(!(Q<F||ha)){var a,
b,c,d,e,f,g,h,k;D.beginPath();a=0;for(b=C.renderItems.length;a<b;a++)if(c=C.renderItems[a],!(c.height>da.MAX_HEIGHT)){k=!1;e=c.footprint;h=[];c=0;for(d=e.length-1;c<d;c+=2)h[c]=f=e[c]-I,h[c+1]=g=e[c+1]-A,k||(k=0<f&&f<s&&0<g&&g<m);if(k){c=0;for(d=h.length-3;c<d;c+=2)k=h[c],e=h[c+1],c?D.lineTo(k,e):D.moveTo(k,e);D.closePath()}}D.fillStyle=la;D.strokeStyle=ka;D.stroke();D.fill()}}};oa=da;var ya,za=function(){var a=Da.createElement("CANVAS");a.style.webkitTransform="translate3d(0,0,0)";a.style.imageRendering=
"optimizeSpeed";a.style.position="absolute";a.style.left=0;a.style.top=0;var b=a.getContext("2d");b.lineCap="round";b.lineJoin="round";b.lineWidth=1;b.mozImageSmoothingEnabled=!1;b.webkitImageSmoothingEnabled=!1;sa.push(a);G.appendChild(a);return b},G=Da.createElement("DIV");G.style.pointerEvents="none";G.style.position="absolute";G.style.left=0;G.style.top=0;var sa=[];ga.setContext(za());oa.setContext(za());w=za();ya={appendTo:function(a){a.appendChild(G);return G},setSize:function(a,b){for(var c=
0,d=sa.length;c<d;c++)sa[c].width=a,sa[c].height=b}};this.setStyle=function(a){a=a||{};if(a.color||a.wallColor)B=T.parse(a.color||a.wallColor),H=B.setAlpha(N)+"",v=B.setLightness(0.8),ka=v.setAlpha(N)+"",Z=B.setLightness(1.2),la=Z.setAlpha(N)+"";a.roofColor&&(Z=T.parse(a.roofColor),la=Z.setAlpha(N)+"");void 0!==a.shadows&&ga.enable(a.shadows);d()};this.setCamOffset=function(a,b){ia=y+a;ja=m+b};this.setMaxZoom=function(a){P=a};this.setDate=function(a){ga.setDate(a)};this.appendTo=function(a){return ya.appendTo(a)};
this.loadData=function(a){C.load(a)};this.setData=function(a){C.set(a)};this.onMoveEnd=function(){d();C.update()};this.onZoomEnd=function(a){ha=!1;n(a.zoom);C.update();d()};this.onZoomStart=function(){ha=!0;d()};this.setOrigin=function(a,b){I=a;A=b};this.setSize=function(a,b){s=a;m=b;y=s/2<<0;z=m/2<<0;ia=y;ja=m;Y=s/(1.5/(window.devicePixelRatio||1))/ta(45)<<0;ya.setSize(s,m);U=Y-50};this.setZoom=n;this.render=f};h.VERSION="0.1.8a";h.ATTRIBUTION='&copy; <a href="http://osmbuildings.org">OSM Buildings</a>';
return h}();
L.BuildingsLayer=L.Class.extend({map:null,osmb:null,container:null,blockMoveEvent:null,lastX:0,lastY:0,initialize:function(e){L.Util.setOptions(this,e)},onMove:function(){var e=L.DomUtil.getPosition(this.map._mapPane);this.osmb.setCamOffset(this.lastX-e.x,this.lastY-e.y);this.osmb.render()},onMoveEnd:function(){if(this.blockMoveEvent)this.blockMoveEvent=!1;else{var e=L.DomUtil.getPosition(this.map._mapPane),J=this.map.getPixelOrigin();this.lastX=e.x;this.lastY=e.y;this.container.style.left=-e.x+"px";
this.container.style.top=-e.y+"px";this.osmb.setCamOffset(0,0);this.osmb.setSize(this.map._size.x,this.map._size.y);this.osmb.setOrigin(J.x-e.x,J.y-e.y);this.osmb.onMoveEnd()}},onZoomStart:function(){this.osmb.onZoomStart()},onZoomEnd:function(){var e=L.DomUtil.getPosition(this.map._mapPane),J=this.map.getPixelOrigin();this.osmb.setOrigin(J.x-e.x,J.y-e.y);this.osmb.onZoomEnd({zoom:this.map._zoom});this.blockMoveEvent=!0},addTo:function(e){e.addLayer(this);return this},onAdd:function(e){this.map=e;
e=this.map._panes.overlayPane;this.osmb?e.appendChild(this.container):(this.osmb=new OSMBuildings,this.container=this.osmb.appendTo(e),this.osmb.maxZoom=this.map._layersMaxZoom);e=L.DomUtil.getPosition(this.map._mapPane);var J=this.map.getPixelOrigin();this.osmb.setSize(this.map._size.x,this.map._size.y);this.osmb.setOrigin(J.x-e.x,J.y-e.y);this.osmb.setZoom(this.map._zoom);this.container.style.left=-e.x+"px";this.container.style.top=-e.y+"px";this.map.on({move:this.onMove,moveend:this.onMoveEnd,
zoomstart:this.onZoomStart,zoomend:this.onZoomEnd},this);this.map.attributionControl.addAttribution(OSMBuildings.ATTRIBUTION);this.osmb.render()},onRemove:function(e){e.attributionControl.removeAttribution(OSMBuildings.ATTRIBUTION);e.off({move:this.onMove,moveend:this.onMoveEnd,zoomstart:this.onZoomStart,zoomend:this.onZoomEnd},this);this.container.parentNode.removeChild(this.container)},setStyle:function(e){this.osmb.setStyle(e);return this},setDate:function(e){this.osmb.setDate(e);return this},
load:function(e){this.osmb.loadData(e);return this},geoJSON:function(e){this.osmb.setData(e);return this}});
